<!DOCTYPE html>
<!--[if lt IE 7 ]>
<html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]>
<html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]>
<html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html lang="en">
<!--<![endif]-->

<head>

  <meta charset="utf-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1, maximum-scale=1" name="viewport">
  <meta content="" name="description">
  <meta content="" name="author">
  <meta content="" name="keywords">

  <title>ngx-state-store | Documentation by Oleg Soloviov</title>

  <link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon">

  <link href="fonts/font-awesome-4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <link href="css/stroke.css" rel="stylesheet" type="text/css">
  <link href="css/bootstrap.css" rel="stylesheet" type="text/css">
  <link href="css/animate.css" rel="stylesheet" type="text/css">
  <link href="css/prettyPhoto.css" rel="stylesheet" type="text/css">
  <link href="css/style.css" rel="stylesheet" type="text/css">

  <link href="js/syntax-highlighter/styles/shCore.css" media="all" rel="stylesheet" type="text/css">
  <link href="js/syntax-highlighter/styles/shThemeRDark.css" media="all" rel="stylesheet" type="text/css">

  <!-- CUSTOM -->
  <link href="css/custom.css" rel="stylesheet" type="text/css">

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->

</head>

<body>
<button id="myBtn" onclick="topFunction()" title="Go to top"><i aria-hidden="true" class="fa fa-chevron-up"></i>
</button>

<script>
    var mybutton = document.getElementById("myBtn");
    window.onscroll = function () {
        scrollFunction()
    };

    function scrollFunction() {
        if (document.body.scrollTop > 1000 || document.documentElement.scrollTop > 1000) {
            mybutton.style.display = "block";
        } else {
            mybutton.style.display = "none";
        }
    }

    function topFunction() {
        window.scrollTo({top: 0, behavior: 'smooth'})
        document.documentElement.scrollTo({top: 0, behavior: 'smooth'})
    }

    document.addEventListener("DOMContentLoaded", () => {
        document.querySelector('#mode').addEventListener('click', () => {
            document.querySelector('html').classList.toggle('dark');
        })
    });


</script>

<div id="wrapper">

  <div id="mode">
    <div class="dark">
      <svg aria-hidden="true" viewBox="0 0 512 512">
        <title>lightmode</title>
        <path
            d="M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"
            fill="currentColor"></path>
      </svg>
    </div>
    <div class="light">
      <svg aria-hidden="true" viewBox="0 0 512 512">
        <title>darkmode</title>
        <path
            d="M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"
            fill="currentColor"></path>
      </svg>
    </div>
  </div>

  <div class="container">

    <section class="section docs-heading" id="top">

      <div class="row">
        <div class="col-md-12">
          <div class="big-title text-center">
            <h1>STATE-STORE</h1>
            <p class="lead">Sample application for the <span>Ngx-State-Store</span> module usage features
              demonstration.</p>
          </div>
          <!-- end title -->
        </div>
        <!-- end 12 -->
      </div>
      <!-- end row -->

      <hr>

    </section>
    <!-- end section -->

    <div class="row">

      <div class="col-md-3">
        <nav class="docs-sidebar" data-offset-bottom="200" data-offset-top="300" data-spy="affix"
             role="navigation">
          <ul class="nav">
            <li><a href="#line1">Simple example</a>
              <ul class="nav">
                <li><a href="#line1_1">Create a state object</a></li>
                <li><a href="#line1_2">Create an initial state object</a></li>
                <li><a href="#line1_3">Register the module</a></li>
                <li><a href="#line1_4">Create an action</a></li>
                <li><a href="#line1_5">Create an action factory</a></li>
                <li><a href="#line1_6">Update some state</a></li>
                <li><a href="#line1_7">Subscribe to some state</a></li>
              </ul>
            </li>
            <li><a href="#line2">More complex use case</a>
              <ul class="nav">
                <li><a href="#line2_1">Extend the state object</a></li>
                <li><a href="#line2_2">Extend the initial state object</a></li>
                <li><a href="#line2_3">Create new actions</a></li>
                <li><a href="#line2_4">Extend the action factory</a></li>
                <li><a href="#line2_5">Load the data</a></li>
                <li><a href="#line2_6">Subscribe to the new states</a></li>
              </ul>
            </li>
            <li><a href="#line3">API overview</a>
                <ul class="nav">
                    <li><a href="#line3_1">Store</a></li>
                    <li><a href="#line3_2">ObjectComparator</a></li>
                    <li><a href="#line3_3">StateHelper</a></li>
                    <li><a href="#line3_4">StateContext</a></li>
                    <li><a href="#line3_5">Action</a></li>
                </ul>
            </li>
            <li><a href="#line4">Sources & Example</a></li>
            <li><a href="#line5">Changelog</a></li>
            <li><a href="#line6">TM Trademarks</a></li>
            <li><a href="#line7">Copyright and license</a></li>
          </ul>
        </nav>
      </div>
      <div class="col-md-9">
        <section class="welcome">

          <div class="row">
            <div class="col-md-12 left-align">
              <h2 class="dark-text">Introduction
                <hr>
              </h2>
              <div class="row">

                <div class="col-md-12 full">
                  <div class="intro1">
                    <ul>
                      <li><strong>Module Name </strong> ngx-state-store</li>
                      <li><strong>Module Version </strong> 1.0.18</li>
                      <li><strong>Documentation Version </strong> 1.0.3</li>
                      <li><strong>Authors </strong>
                        <div class="authors-list">
                          <a href="https://www.xing.com/profile/Oleg_Soloviov"
                            target="_blank">Oleg Soloviov</a>
                          <a href="https://www.xing.com/profile/Spartak_Akhmedov"
                            target="_blank">Spartak Akhmedov</a>
                        </div>
                      </li>
                      <li><strong>Company </strong> <a
                          href="http://it-and-services.net"
                          target="_blank">IT&S Information Technologies and Services GmbH</a>
                      </li>
                      <li><strong>License </strong> <a
                          href="https://choosealicense.com/licenses/mit/"
                          target="_blank">MIT License</a></li>
                    </ul>
                  </div>

                  <hr>
                  <div>
                    <p><strong>ngx-state-store</strong> is based on <a
                        href="https://rxjs-dev.firebaseapp.com/guide/overview" target="_blank">RxJS</a>, easy to learn
                      and use, light and quick the state management module for the Angular applications starting from
                      the <strong>Angular version >= 7.2.0</strong>
                    </p>

                    <p><strong>state-store</strong> is the sample Angular application for the
                      <strong>ngx-state-store</strong> module usage features demonstration.
                    </p>

                    <p><strong>ngx-state-store</strong> and <strong>state-store</strong> were updated and tested up to
                      the <strong>Angular version 13</strong>
                    </p>

                    <p>This documentation is to help you regarding the <strong>ngx-state-store</strong> module.
                      The presented simplified code examples are to help you to grasp the
                      major idea behind the module.</p>

                    <p>The benefits of using the <strong>ngx-state-store</strong> in comparison to other
                      known state management frameworks are: much less written code, better overview over the code,
                      subscription to async actions, simple to refactor by new implementation of an action.</p>

                    <h4>Requirements</h4>
                    <p>It is expected to have the following knowledge:</p>
                    <ol>
                      <li><a href="https://www.typescriptlang.org/" target="_blank">TypeScript</a>
                        is an open-source language which builds on JavaScript, one of the
                        worldâ€™s most used tools, by adding static type definitions.
                      </li>
                      <li><a href="https://angular.io/" target="_blank">Angular</a> is a platform and
                        framework for building single-page client applications using HTML and TypeScript.
                      </li>
                      <li><a href="https://rxjs-dev.firebaseapp.com/guide/overview"
                             target="_blank">RxJS</a> is the library for composing asynchronous and
                        event-based programs by using observable sequences.
                      </li>
                      <li>Understanding of the necessity of the state management in the modern web
                        applications.
                      </li>
                      <li>Some modern web development platform like for example IntelliJ WebStorm
                        or Microsoft Visual Studio Code for the TypeScript/Angular development.
                      </li>
                    </ol>

                  </div>
                </div>

              </div>
              <!-- end row -->
            </div>
          </div>
        </section>

        <section class="section" id="line1">

          <div class="row">
            <div class="col-md-12 left-align">
              <h2 class="dark-text">Simple example
                <hr>
              </h2>
            </div>
            <!-- end col -->
          </div>
          <!-- end row -->

          <div class="row" id="line1_1">
            <div class="col-md-12">
              <h4>Create a state object</h4>

              <div>Source: src/app/services/state-store/app-state.ts</div>
              <pre class="brush: typescript">
              export interface AppState {
                Counter: number;
              }
              </pre>
            </div>
          </div>
          <!-- end row -->

          <hr>

          <div class="row" id="line1_2">
            <div class="col-md-12">
              <h4>Create an initial state object</h4>

              <div>Source: src/app/services/state-store/app-initial-state.ts</div>
              <pre class="brush: typescript">
              import { AppState } from './app-state';

              export const AppInitialState: AppState = {
                Counter: 0
              };
              </pre>
            </div>
          </div>
          <!-- end row -->

          <hr>

          <div class="row" id="line1_3">
            <div class="col-md-12">
              <h4>Register the module</h4>

              <div>Source: src/app/app.module.ts</div>
              <pre class="brush: typescript">
              // ...
              import { NgModule } from '@angular/core';
              import { AppInitialState } from './services/state-store/app-initial-state';
              import { NgxStateStoreModule } from 'ngx-state-store';
              // ...

              @NgModule({
                declarations: [
                  // ...
                ],
                imports: [
                  // ...
                  NgxStateStoreModule.forRoot({
                    storeName: 'store-demo',
                    log: true,
                    timekeeping: true,
                    initialState: AppInitialState
                  }),
                  // ...
                ],
                // ...
              })
              export class AppModule {
              // ...
              }
              </pre>

              <div>At run time you can access the store in the console by the path <code>window['ngx-state-store']['store-demo']</code>.
              </div>
              <div>To activate/deactivate log and timekeeping at runtime:</div>
              <pre class="brush: javascript">
              window['ngx-state-store']['store-demo'].state.log.log = true;
              window['ngx-state-store']['store-demo'].state.performance.timekeeping = true;
              </pre>
            </div>
          </div>
          <!-- end row -->

          <hr>

          <div class="row" id="line1_4">
            <div class="col-md-12">
              <h4>Create an action</h4>

              <div>Source: src/app/services/state-store/actions/increment-counter.action.ts</div>
              <pre class="brush: typescript">
              import { Action, StateContext } from 'ngx-state-store';
              import { ActionIds } from '../action-ids';
              import { AppState } from '../app-state';

              export class IncrementCounterAction extends Action {
                constructor() {
                  super(ActionIds.UpdateCounter);
                }

                handleState(stateContext: StateContext&lt;AppState&gt;): void {
                  const newValue = this.getEmptyState();
                  newValue.Counter = stateContext.getState().Counter + 1;
                  stateContext.patchState(newValue);
                }
              }
              </pre>

              <div>Source: src/app/services/state-store/action-ids.ts</div>
              <pre class="brush: typescript">
              export enum ActionIds {
                UpdateCounter = '[Common] update counter'
              }
              </pre>
              <div>The ids, like one above - <code>[Common] update counter</code>, will be displayed in
                the console log output.
              </div>
            </div>
          </div>
          <!-- end row -->

          <hr>

          <div class="row" id="line1_5">
            <div class="col-md-12">
              <h4>Create an action factory</h4>

              <div>Source: src/app/services/state-store/action-factory.ts</div>
              <pre class="brush: typescript">
              import { Injectable } from '@angular/core';
              import { Action } from 'ngx-state-store';
              import { IncrementCounterAction } from './actions/increment-counter.action';

              @Injectable()
              export class ActionFactory {
                incrementCounter(): Action {
                  return new IncrementCounterAction();
                }
              }
              </pre>
            </div>
          </div>
          <!-- end row -->

          <hr>

          <div class="row" id="line1_6">
            <div class="col-md-12">
              <h4>Update some state</h4>

              <div>To update some state by an Action use <code>store.dispatch(...)</code>.</div>
              <div>Source: src/app/components/counter-button.component/counter-button.component.ts</div>
              <pre class="brush: typescript">
              import { Component } from '@angular/core';
              import { AppState } from '../../services/state-store/app-state';
              import { ActionFactory } from '../../services/state-store/action-factory';
              import { Store } from 'ngx-state-store';

              @Component({
                selector: 'app-counter-button',
                templateUrl: './counter-button.component.html',
                styleUrls: ['./counter-button.component.scss']
              })
              export class CounterButtonComponent {
                constructor(private store: Store&lt;AppState&gt;,
                  private factory: ActionFactory) {
                }

                incrementCounter() {
                  this.store.dispatch(this.factory.incrementCounter());
                }
              }
              </pre>
            </div>
          </div>
          <!-- end row -->

          <hr>

          <div class="row" id="line1_7">
            <div class="col-md-12">
              <h4>Subscribe to some state</h4>

              <div>To subscribe to some state use <code>store.select(...)</code>.</div>
              <div>Source: src/app/components/counter.component/counter.component.ts</div>
              <pre class="brush: typescript">
              import { Component, OnInit } from '@angular/core';
              import { Store } from 'ngx-state-store';
              import { AppState } from '../../services/state-store/app-state';
              import { Observable } from 'rxjs';

              @Component({
                selector: 'app-counter',
                templateUrl: './counter.component.html',
                styleUrls: ['./counter.component.scss']
              })
              export class CounterComponent implements OnInit {
                counter$: Observable&lt;number&gt;;

                constructor(private store: Store&lt;AppState&gt;) {
                }

                ngOnInit(): void {
                  this.counter$ = this.store.select('Counter');
                }
              }
              </pre>
              <div>The <code>select(...)</code> method returns an Observable.</div>
            </div>
          </div>
          <!-- end row -->

          <br/><br/><br/>
          <div class="intro2 clearfix">
            <p><i class="fa fa-exclamation-triangle"></i> It is a bad design / architecture to put the state
              management inside of the components as the components must be / are expected to be reusable. The
              better approach is to put the state management inside of so called container-components.
              Container-components are the components, that contain all of the reusable components.
              <br/><br/>
              The design and architecture are out of the scope of this documentation. The presented
              examples are simplified for the sake of the clarity.
            </p>
          </div>

        </section>
        <!-- end section -->

        <section class="section" id="line2">

          <div class="row">
            <div class="col-md-12 left-align">
              <h2 class="dark-text">More complex use case
                <hr>
              </h2>

              <p>The more complex use case includes a back-end call.</p>
            </div>
            <!-- end col -->
          </div>
          <!-- end row -->

          <div class="row" id="line2_1">
            <div class="col-md-12">
              <h4>Extend the state object</h4>

              <div>Source: src/app/services/state-store/app-state.ts</div>
              <pre class="brush: typescript">
              import { Inventory } from '../../models/inventory';

              export interface AppState {
                ShowLoadingIndicator: string[];
                Counter: number;
                Inventories: Inventory[];
                // iso Date string
                LastDownloadAt: string;
              }
              </pre>
              <div>Source: src/app/models/inventory.ts</div>
              <pre class="brush: typescript">
              export class Inventory {
                id: number;
                version: string;
                name: string;
              }
              </pre>
            </div>
          </div>
          <!-- end row -->

          <hr>

          <div class="row" id="line2_2">
            <div class="col-md-12">
              <h4>Extend the initial state object</h4>

              <div>Source: src/app/services/state-store/app-initial-state.ts</div>
              <pre class="brush: typescript">
              import { AppState } from './app-state';

              export const AppInitialState: AppState = {
                ShowLoadingIndicator: [],
                Counter: 0,
                Inventories: null,
                LastDownloadAt: ''
              };
              </pre>
            </div>
          </div>
          <!-- end row -->

          <hr>

          <div class="row" id="line2_3">
            <div class="col-md-12">
              <h4>Create new actions</h4>

              <div>Source: src/app/services/state-store/actions/show-loading-indicator.action.ts</div>
              <pre class="brush: typescript">
              import { Action, StateContext } from 'ngx-state-store';
              import { ActionIds } from '../action-ids';
              import { AppState } from '../app-state';

              export class ShowLoadingIndicatorAction extends Action {
                constructor(private identifier: string) {
                  super(ActionIds.ShowLoadingIndicator + ': ' + identifier);
                }

                handleState(stateContext: StateContext&lt;AppState&gt;): void {
                  const newState = this.getEmptyState();
                  newState.ShowLoadingIndicator
                    = stateContext.getState().ShowLoadingIndicator.slice();
                  newState.ShowLoadingIndicator.push(this.identifier);
                  stateContext.patchState(newState);
                }
              }
              </pre>

              <div>Source: src/app/services/state-store/actions/hide-loading-indicator.action.ts</div>
              <pre class="brush: typescript">
              import { Action, StateContext } from 'ngx-state-store';
              import { ActionIds } from '../action-ids';
              import { AppState } from '../app-state';

              export class HideLoadingIndicatorAction extends Action {
                constructor(private identifier: string) {
                  super(ActionIds.HideLoadingIndicator + ': ' + identifier);
                }

                handleState(stateContext: StateContext&lt;AppState&gt;): void {
                  if (stateContext.getState().ShowLoadingIndicator == null) {
                    return;
                  }

                  const index = stateContext.getState()
                    .ShowLoadingIndicator.indexOf(this.identifier);
                  if (index < 0) {
                    return;
                  }

                  const newState: AppState = this.getEmptyState();
                  newState.ShowLoadingIndicator
                    = stateContext.getState().ShowLoadingIndicator.slice();
                  newState.ShowLoadingIndicator.splice(index, 1);
                  stateContext.patchState(newState);
                }
              }
              </pre>

              <div>Source: src/app/services/state-store/actions/load-inventories.action.ts</div>
              <pre class="brush: typescript">
              import { Action, StateContext } from 'ngx-state-store';
              import { ActionIds } from '../action-ids';
              import { AppState } from '../app-state';
              import { InventoryConnector } from '../../connectors/inventory.connector';
              import { Observable } from 'rxjs';
              import { tap } from 'rxjs/operators';

              export class LoadInventoriesAction extends Action {
                constructor(private inventoryConnector: InventoryConnector) {
                  super(ActionIds.LoadInventories);
                }

                handleState(stateContext: StateContext&lt;AppState&gt;): Observable&lt;any&gt; {
                  return this.inventoryConnector.loadInventory()
                    .pipe(
                      tap(inventories => {
                        const newState: AppState = this.getEmptyState();
                        newState.Inventories = inventories;
                        newState.LastDownloadAt = (new Date()).toISOString();
                        stateContext.patchState(newState);
                      })
                  );
                }
              }
              </pre>
            </div>
          </div>
          <!-- end row -->

          <hr>

          <div class="row" id="line2_4">
            <div class="col-md-12">
              <h4>Extend the action factory</h4>

              <div>Source: src/app/services/state-store/action-factory.ts</div>
              <pre class="brush: typescript">
              import { Injectable } from '@angular/core';
              import { Action } from 'ngx-state-store';
              import { ShowLoadingIndicatorAction } from './actions/show-loading-indicator.action';
              import { IncrementCounterAction } from './actions/increment-counter.action';
              import { HideLoadingIndicatorAction } from './actions/hide-loading-indicator.action';
              import { LoadInventoriesAction } from './actions/load-inventories.action';
              import { InventoryConnector } from '../connectors/inventory.connector';

              export enum LoadIndicator {
                DEFAULT = 'DEFAULT',
                LOAD_INVENTORIES = 'LOAD_INVENTORIES'
              }

              @Injectable()
              export class ActionFactory {
                constructor(private inventoryConnector: InventoryConnector) {
                }

                incrementCounter(): Action {
                  return new IncrementCounterAction();
                }

                showLoadIndicator(identifier: string = LoadIndicator.DEFAULT): Action {
                  return new ShowLoadingIndicatorAction(identifier);
                }

                hideLoadIndicator(identifier: string = LoadIndicator.DEFAULT): Action {
                  return new HideLoadingIndicatorAction(identifier);
                }

                loadInventories(): Action {
                  return new LoadInventoriesAction(this.inventoryConnector);
                }
              }
              </pre>

              <div>Source: src/app/services/connectors/inventory.connector.ts</div>
              <pre class="brush: typescript">
              import { Injectable } from '@angular/core';
              import { Observable } from 'rxjs';
              import { HttpClient } from '@angular/common/http';
              import { Inventory } from '../../models/inventory';
              import { delay } from 'rxjs/operators';

              @Injectable()
              export class InventoryConnector {
                constructor(private http: HttpClient) {
                }

                loadInventory(): Observable&lt;Inventory[]&gt; {
                  // delay(2000) to imitate the network throttling
                  return this.http.get&lt;Inventory[]&gt;('assets/mock-data/inventories.json')
                    .pipe(delay(2000));
                }
              }
              </pre>
            </div>
          </div>
          <!-- end row -->

          <hr>

          <div class="row" id="line2_5">
            <div class="col-md-12">
              <h4>Load the data</h4>

              <div>To load the data from the back-end and update the states by the Actions use
                <code>store.dispatch(...)</code>
              </div>
              <div>Source:
                src/app/components/inventories-button.component/inventories-button.component.ts
              </div>
              <pre class="brush: typescript">
              import { Component, OnInit } from '@angular/core';
              import { Store } from 'ngx-state-store';
              import { AppState } from '../../services/state-store/app-state';
              import { ActionFactory, LoadIndicator } from '../../services/state-store/action-factory';
              import { catchError, mergeMap, skip } from 'rxjs/operators';
              import { of } from 'rxjs';
              import { Inventory } from '../../models/inventory';

              export interface Changes {
                addedEntries: Inventory[];
                removedEntries: Inventory[];
              }

              @Component({
                selector: 'app-inventories-button',
                templateUrl: './inventories-button.component.html',
                styleUrls: ['./inventories-button.component.scss']
              })
              export class InventoriesButtonComponent implements OnInit {
                lastDownloadAt: string;
                changes: Changes = {addedEntries: [], removedEntries: []} as Changes;
                private inventories: Inventory[] = [];

                constructor(private store: Store&lt;AppState&gt;,
                  private factory: ActionFactory) {
                }

                ngOnInit(): void {
                  this.store.select('Inventories',
                    (oldInventories: Inventory[], newInventories: Inventory[]) => {
                    if (oldInventories === newInventories
                      || oldInventories && newInventories
                      && !this.calcDiff(oldInventories, newInventories).length
                      && !this.calcDiff(newInventories, oldInventories).length) {
                      return true;
                    }
                    return false;
                  }).pipe(skip(1))
                  .subscribe((newInventories) => {
                    this.changes.addedEntries = this.calcDiff(this.inventories, newInventories);
                    this.changes.removedEntries = this.calcDiff(newInventories, this.inventories);
                    this.inventories = newInventories;
                    console.log('the log is present only if there are some changes');
                  });
                }

                private calcDiff(source: Inventory[], target: Inventory[]): Inventory[] {
                  return (target || []).filter(t => !(source || []).find(s => s.id === t.id));
                }

                loadInventory() {
                  this.changes.addedEntries = [];
                  this.changes.removedEntries = [];
                  this.store.dispatch(
                    this.factory.showLoadIndicator(LoadIndicator.LOAD_INVENTORIES))
                  .pipe(
                    mergeMap(() => this.store.dispatch(this.factory.loadInventories())),
                    catchError(error => {
                      console.log(error);
                      return of(error);
                    })
                  ).subscribe((state: AppState) => {
                      this.lastDownloadAt = state.LastDownloadAt;
                      this.store.dispatch(this.factory.hideLoadIndicator(LoadIndicator.LOAD_INVENTORIES));
                    }
                  );
                }

                inventoriesToString(inventories: Inventory[]): string {
                  return inventories.map(e => e.id).toString();
                }
              }
              </pre>

            </div>
          </div>
          <!-- end row -->

          <hr>

          <div class="row" id="line2_6">
            <div class="col-md-12">
              <h4>Subscribe to the new states</h4>

              <div>To subscribe to the new states use store.select(...)</div>
              <div>Source: src/app/components/inventories.component/inventories.component.ts</div>
              <pre class="brush: typescript">
              import { Component, OnInit } from '@angular/core';
              import { Store } from 'ngx-state-store';
              import { AppState } from '../../services/state-store/app-state';
              import { Inventory } from '../../models/inventory';
              import { Observable, of } from 'rxjs';
              import { mergeMap } from 'rxjs/operators';
              import { LoadIndicator } from '../../services/state-store/action-factory';

              @Component({
                selector: 'app-inventories',
                templateUrl: './inventories.component.html',
                styleUrls: ['./inventories.component.scss']
              })
              export class InventoriesComponent implements OnInit {
                inventories: Inventory[];
                loading$: Observable&lt;boolean&gt;;

                constructor(private store: Store&lt;AppState&gt;) {
                }

                ngOnInit(): void {
                  this.loading$ = this.store.select('ShowLoadingIndicator').pipe(
                    map(indicators =>
                      indicators.filter(i => i === LoadIndicator.LOAD_INVENTORIES).length > 0)
                  );
                  this.store.select('Inventories').subscribe(inventories => {
                    this.inventories = inventories;
                  });
                }
              }
              </pre>
              <div>The observables returned from the <code>store.select(...)</code> return a frozen (read only) state
                  objects that were frozen by the <code>StateHelper.deepFreeze(any)</code>. Use
                  <code>StateHelper.cloneObject(any, cloneFunctions = true)</code> to get a clone of the frozen object
                  including the functions (default) if it is needed.
              </div>

              <br/><br/><br/>
              <div class="intro2 clearfix">
                <p><i class="fa fa-exclamation-triangle"></i> Keep in mind that all objects passed to the state
                    store will be frozen. The freeze process is based on JavaScript <code>Object.freeze()</code>
                </p>
              </div>
            </div>
          </div>
          <!-- end row -->

          <hr>

        </section>
        <!-- end section -->

        <section class="section" id="line3">

          <div class="row">
            <div class="col-md-12 left-align">
              <h2 class="dark-text">API overview
                <hr>
              </h2>
            </div>
            <!-- end col -->
          </div>
          <!-- end row -->

            <div class="row" id="line3_1">
              <div class="col-md-12">
                <h4>Store</h4>

                  <ul>
                      <li><strong>select</strong>
                          - <code>select(string, ObjectComparator?): Observable&lt;any&gt;</code>
                          - select some state of the state store, <code>ObjectComparator</code> is optional.
                        The ObjectComparator can be used to implement more advanced comparison of the potential changes.
                        It is also convenient way to only subscribe to some property/properties changes of some state
                        object.</li>
                      <li><strong>selectOnce</strong>
                          - <code>selectOnce(string): Observable&lt;any&gt;</code>
                          - the same as <code>select</code> but the Observable terminates after forward one value.</li>
                      <li><strong>dispatch</strong>
                          - <code>dispatch(action: Action): Observable&lt;state: S&gt;</code>
                          - dispatch the Action that changes some state, the dispatch function always returns an
                          Observable of your newest state.</li>
                  </ul>

                  <br />
                  <div class="intro2 clearfix">
                    <p><i class="fa fa-comment"> Tip:</i> You could join many dispatch
                        calls in a pipe and have access to the last state change from the previous call. In this case,
                        the preferable way to do any changes of the state is by returning an Observable. The Observable
                        itself returning value does not have any meaning. For the return value inside of the Observable
                        you could use <code>return of(null);</code> from rxjs, or operator function <code>tap((x: T) =>
                        void)</code>.
                        <br />
                        see the examples: inventories-button.component.ts and load-inventories.action.ts
                        <br />
                        in the example load-inventories.action.ts the access to the &lt;state: S&gt; is in the
                        subscription.
                    </p>
                  </div>

                  <br />
                  <div>Pseudo code example:</div>
                  <pre class="brush: typescript">
                  this.store.dispatch(&lt;some action&gt;)
                  .pipe(
                    mergeMap((state: S) => {
                      // ... read and use data from the state
                      return this.store.dispatch(&lt;another action&gt;);
                    }),
                    mergeMap((state: S) => {
                      // ... read and use data from the state
                      return this.store.dispatch(&lt;another action 2&gt;);
                    })
                  ).subscribe((state: S) => {
                    // ... read and use data from the state
                  });
                  </pre>

                  <br/>
                  <strong><i>dispatch rules:</i></strong>
                  <div class="code-nowrap">
                    <strong><i>1)</i></strong> Do not use
                    <code><s>store.select(string)</s></code> in the subscription / pipe to
                    <code>store.dispatch(&lt;some action&gt;)</code>.
                    <br/>
                    The <code>store.dispatch(&lt;some action&gt;)</code> returns an Observable that emits only one value,
                    that is newest state, and terminates, whereas the <code>store.select(string)</code> returns an
                    Observable that emits the value every time the state was changed. As the result the subscription
                    stays further active.
                  </div>

                  <div class="code-nowrap">
                    <strong><i>2)</i></strong> The <code>store.selectOnce(string)</code> returns stale state if it is
                    placed in the subscription / pipe to <code>store.dispatch(&lt;some action&gt;)</code>. This applies, when
                    the dispatching action changes the state.
                    <br/>
                    Only the state emitted by the Observable returned by the <code>store.dispatch(&lt;some action&gt;)</code>
                    and the state of the StateContext in the <code>action.handleState(stateContext)</code> are the
                    newest in the subscription / pipe to <code>store.dispatch(&lt;some action&gt;)</code>.
                  </div>
                  <br/>

                  <div>Code snippet that demonstrates the <code>store.dispatch(&lt;some action&gt;)</code> rules</div>
                  <div>Source: projects/ngx-state-store/src/lib/state/store.service.spec.ts</div>
                  <pre class="brush: typescript">
                  describe('dispatch, pipe and selectOnce', () => {
                    let store: Store&lt;any&gt;;
                    beforeEach(() => {
                      TestBed.configureTestingModule({
                        providers: [Store, {
                            provide: STATE_CONFIG,
                            useValue: {initialState: {Counter: 0}}  // initial Counter = 0
                        }]
                      });
                      store = TestBed.inject(Store);
                    });

                    it('selecting stale state by subscribe to dispatch', (done) => {
                      of(null)
                        .pipe(
                          mergeMap(() => store.dispatch({
                            handleState(stateContext: StateContext&lt;any&gt;): Observable&lt;void&gt; {

                              expect(stateContext.getState().Counter).toBe(0); // initial - Counter = 0

                              return of(null)
                                .pipe(
                                  tap(() => {
                                    stateContext.patchState({Counter: 1}); // patch state - Counter = 1
                                  })
                                );
                            }
                          } as Action)),
                          mergeMap((newState) => store.dispatch({
                            handleState(stateContext: StateContext&lt;any&gt;): Observable&lt;void&gt; {

                              // the returned state from dispatch is always new state - Counter = 1
                              expect(newState.Counter).toBe(1); // new state - Counter = 1

                              // the state of the stateContext is also new state - Counter = 1
                              expect(stateContext.getState().Counter).toBe(1); // new state - Counter = 1

                              return of(null)
                                .pipe(
                                  tap(() => {
                                    stateContext.patchState({Counter: 2}); // patch state - Counter = 2
                                  })
                                );
                            }
                          } as Action))
                        )
                        .subscribe(newState => {

                          // the returned state from dispatch is always new state - Counter = 2
                          expect(newState.Counter).toBe(2); // new state - Counter = 2

                          // the returned state from selectOnce is stale state - Counter = 1
                          store.selectOnce('Counter').subscribe((staleCounterValue) => {
                            expect(staleCounterValue).toBe(1); // stale state - Counter = 1
                            done();
                          });
                        });
                    });
                  });
                  </pre>

              </div>
            </div>
            <!-- end row -->

            <hr>

            <div class="row" id="line3_2">
                <div class="col-md-12">
                  <h4>ObjectComparator</h4>

                  <p><code>export type ObjectComparator = (oldObject: any, newObject: any) => boolean;</code> - is a
                    function. The ObjectComparator can be used by
                    <code>Store.select(string, ObjectComparator?): Observable&lt;any&gt;</code> as second parameter.
                    By the ObjectComparator you may implement more advanced comparison of the potential changes.
                    <br />
                      The method must return <code>true</code> if there are no changes you are interested in. For
                      example the property/properties of some state object was/were not changed.</p>

                  <div>Pseudo code example:</div>
                  <pre class="brush: typescript">
                  this.store.select('&lt;some state&gt;', (oldObjectState: any, newObjectState: any) => {
                    // here you can compare if the value of some property was changed
                    if (oldObjectState === newObjectState || oldObjectState && newObjectState
                      && oldObjectState['someProperty'] === newObjectState['someProperty']) {
                      // nothing changed
                      return true;
                    }

                    // someProperty of the state object was changed
                    return false;
                  }).subscribe((state: S) => {
                    // ... do somethig if the newObjectState partly changed
                  });
                  </pre>
                </div>
            </div>
            <!-- end row -->

            <hr>

            <div class="row" id="line3_3">
              <div class="col-md-12">
                <h4>StateHelper</h4>

                <p>Besides the simply structured JSON objects, also the objects of the types: Date, Map and Set may be
                  used in the state. The StateHelper can make them immutable and clone them accordingly. Also the
                  objects with any kind of cyclic dependencies of its properties may be used in the state, for example
                  composite or hierarchical properties or lists with the parent child relations where the leaves
                  reference each other in different ways. The StateHelper can make them immutable and clone them
                  respectively, and it keeps the relations.</p>

                <ul>
                    <li><strong>deepFreeze</strong>
                        - <code>static deepFreeze&lt;T&gt;(o: T): T</code>
                        - freezes the object, the object is read only after the call. Also the objects/properties of
                          the types: Sat, Map and Date are immutable. The freeze process is based on  JavaScript
                          <code>Object.freeze()</code>.</li>
                    <li><strong>cloneObject</strong>
                        - <code>static cloneObject&lt;T&gt;(o: T, cloneFunctions = true): T</code>
                        - creates a clone of the object including functions (default), the method is useful if the
                          object was frozen by the <code>deepFreeze</code>. The method handles also objects with any
                          kind of cyclic dependencies of its properties.</li>
                </ul>

              </div>
            </div>
            <!-- end row -->

            <hr>

            <div class="row" id="line3_4">
              <div class="col-md-12">
                <h4>StateContext</h4>

                <ul>
                    <li><strong>getState</strong>
                        - <code>getState(): S</code>
                        - returns the whole current state.</li>
                    <li><strong>patchState</strong>
                        - <code>patchState(val: Partial&lt;S&gt;)</code>
                        - patch the existing state with the provided value.</li>
                    <li><strong>setState</strong>
                        - <code>setState(state: S)</code>
                        - reset the whole state to a new value.</li>
                </ul>

              </div>
            </div>
            <!-- end row -->

            <hr>

            <div class="row" id="line3_5">
                <div class="col-md-12">
                  <h4>Action</h4>

                  <ul>
                    <li><strong>handleState</strong>
                        - <code>abstract handleState(stateContext: StateContext&lt;any&gt;): Observable&lt;any&gt; | void</code>
                        - it must be implemented by the user.</li>
                    <li><strong>clone</strong>
                        - <code>clone&lt;T&gt;(o: T, cloneFunctions = true): T</code>
                        - clone the object including functions (default), the same as <code>StateHelper.cloneObject(o,
                            cloneFunctions = true)</code>.</li>
                  </ul>
                </div>
            </div>
            <!-- end row -->

            <hr>

        </section>
        <!-- end section -->

        <section class="section" id="line4">

          <div class="row">
            <div class="col-md-12 left-align">
              <h2 class="dark-text">Sources & Example
                <hr>
              </h2>
            </div>
            <!-- end col -->
          </div>
          <!-- end row -->

          <div class="row">
            <div class="col-md-12">

              <p>The source code can be downloaded from the GitHub <a
                  href="https://github.com/it-and-services/state-store"
                  target="_blank">https://github.com/it-and-services/state-store</a>.

              </p>

              <p>
                <strong>ngx-state-store : </strong> NPM module online <a
                  href="https://www.npmjs.com/package/ngx-state-store"
                  target="_blank">https://www.npmjs.com/package/ngx-state-store</a>.
              </p>

              <p>
                <strong>state-store : </strong> The <a href="#line1">Simple example</a> and <a href="#line2">More
                  complex use case</a> presented here in the documentation are running as the online App <a
                  href="https://it-and-services.github.io/state-store/app.html"
                  target="_blank">https://it-and-services.github.io/state-store/app.html</a>.
              </p>
            </div>

          </div>
          <!-- end row -->

        </section>
        <!-- end section -->

        <section class="section" id="line5">

          <div class="row">
            <div class="col-md-12 left-align">
              <h2 class="dark-text">Changelog
                <hr>
              </h2>
            </div>
            <!-- end col -->
          </div>
          <!-- end row -->

          <div class="row">
            <div class="col-md-12">

              <p>The history section consists of two parts. The first part is regarding the
                <strong>ngx-state-store</strong> changes. The second part is regarding the documentation
                changes.</p>

              <hr>

              <h4>Ngx-State-Store Changelog</h4>

              <pre class="brush: html">

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.18 - 28 Oct 2021
                                        -----------------------------------------------------------------------------------------
                                        - the Angular update remark was moved out of the release into the documentation
                                          to avoid empty releases just because of the Angular update

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.17 - 21 May 2021
                                        -----------------------------------------------------------------------------------------
                                        - updated and tested up to the Angular 12

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.16 - 29 Apr 2021
                                        -----------------------------------------------------------------------------------------
                                        - Date, Map and Set objects may be used in the state
                                        - StateHelper.cloneObject() was extended to clone Date, Map and Set
                                        - StateHelper.deepFreeze() was extended to make Date, Map and Set immutable

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.15 - 14 Apr 2021
                                        -----------------------------------------------------------------------------------------
                                        - cyclic dependencies resolution by the StateHelper.cloneObject()
                                        - prevent to clone the window by the StateHelper.cloneObject()
                                        - prevent to freeze the window by the StateHelper.deepFreeze()
                                        - check return value of the Action.handleState() by rxjs isObservable()

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.14 - 28 Mar 2021
                                        -----------------------------------------------------------------------------------------
                                        - externalize the documentation

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.13 - 20 Nov 2020
                                        -----------------------------------------------------------------------------------------
                                        - improve documentation

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.12 - 20 Nov 2020
                                        -----------------------------------------------------------------------------------------
                                        - updated to Angular 11
                                        - extend performance plugin by the 'limit' parameter, default value is 1000
                                        - improve documentation

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.11 - 13 Jul 2020
                                        -----------------------------------------------------------------------------------------
                                        - improve documentation
                                        - update example application

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.10 - 26 Jun 2020
                                        -----------------------------------------------------------------------------------------
                                        - improve documentation

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.9 - 28 Apr 2020
                                        -----------------------------------------------------------------------------------------
                                        - improve documentation

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.8 - 25 Mar 2020
                                        -----------------------------------------------------------------------------------------
                                        - improve documentation

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.7 - 10 Feb 2020
                                        -----------------------------------------------------------------------------------------
                                        - improve documentation

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.6 - 30 Jan 2020
                                        -----------------------------------------------------------------------------------------
                                        - hide second parameter in the StateHelper.cloneObject(any)

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.5 - 28 Jan 2020
                                        -----------------------------------------------------------------------------------------
                                        - improve documentation
                                        - increase test coverage

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.4 - 14 Jan 2020
                                        -----------------------------------------------------------------------------------------
                                        - add clone Date into the StateHelper.cloneObject()

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.3 - 8 Jan 2020
                                        -----------------------------------------------------------------------------------------
                                        - add keywords into the package.json

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.2 - 7 Jan 2020
                                        -----------------------------------------------------------------------------------------
                                        - improve documentation
                                        - the plugins are always enabled

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.1 - 6 Jan 2020
                                        -----------------------------------------------------------------------------------------
                                        - improve documentation
                                        - improve build process
                                        - increase test coverage

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.0 - 5 Jan 2020
                                        -----------------------------------------------------------------------------------------
                                        - first release
                                        - supported applications with Angular version >= 7.2.0

                                        -----------------------------------------------------------------------------------------
                                        Version 0.0.1 - 4 Jan 2020
                                        -----------------------------------------------------------------------------------------
                                        - first beta release


                            </pre>

              <p></p>

              <hr>

              <h4>Ngx-State-Store Documentation Changelog</h4>

              <pre class="brush: html">

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.3 - 8 Nov 2021
                                        -----------------------------------------------------------------------------------------
                                        - Remark about Angular update upto the version 13

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.2 - 21 May 2021
                                        -----------------------------------------------------------------------------------------
                                        - StateHelper functional description
                                          see: 'API overview/StateHelper' section

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.1 - 29 Apr 2021
                                        -----------------------------------------------------------------------------------------
                                        - introduction of dispatch rules
                                          see: 'API overview/Store/dispatch rules' section

                                        -----------------------------------------------------------------------------------------
                                        Version 1.0.0 - 28 Mar 2021
                                        -----------------------------------------------------------------------------------------
                                        - initial HTML based documentation


              </pre>

            </div>
          </div>
          <!-- end row -->

        </section>
        <!-- end section -->

        <section class="section" id="line6">

          <div class="row">
            <div class="col-md-12 left-align">
              <h2 class="dark-text">TM Trademarks
                <hr>
              </h2>
            </div>
            <!-- end col -->
          </div>
          <!-- end row -->

          <div class="row">
            <div class="col-md-12">

              <p>JavaScript is a registered trademark of Oracle Corporation.</p>
              <p>TypeScript is a registered trademark of Lotus Development Corporation.</p>
              <p>IntelliJ is a registered trademarks of JetBrains s.r.o.</p>
              <p>WebStorm is a registered trademarks of JetBrains s.r.o.</p>
              <p>Microsoft is a registered trademark of Microsoft Corporation.</p>
              <p>Visual Studio Code is a registered trademark of Microsoft Corporation.</p>
              <p>All other product, company, and service names as well as company logos mentioned are the
                property of their respective owners and are mentioned for identification purposes
                only.</p>

            </div>
          </div>
          <!-- end row -->

        </section>
        <!-- end section -->

        <section class="section" id="line7">

          <div class="row">
            <div class="col-md-12 left-align">
              <h2 class="dark-text">Copyright and license
                <hr>
              </h2>
            </div>
            <!-- end col -->
          </div>
          <!-- end row -->

          <div class="row">
            <div class="col-md-12">

              <p>Code released under the <a href="https://choosealicense.com/licenses/mit/"
                                            target="_blank">MIT License</a>.</p>
              <p>For more information about copyright and license check <a
                  href="https://choosealicense.com/" target="_blank">choosealicense.com</a>.</p>

            </div>
          </div>
          <!-- end row -->

        </section>
        <!-- end section -->
      </div>
      <!-- // end .col -->

    </div>
    <!-- // end .row -->

  </div>
  <!-- // end container -->

</div>
<!-- end wrapper -->

<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/retina.js"></script>
<script src="js/jquery.fitvids.js"></script>
<script src="js/wow.js"></script>
<script src="js/jquery.prettyPhoto.js"></script>

<!-- CUSTOM PLUGINS -->
<script src="js/custom.js"></script>
<script src="js/main.js"></script>

<script src="js/syntax-highlighter/scripts/shCore.js"></script>
<script src="js/syntax-highlighter/scripts/shBrushXml.js"></script>
<script src="js/syntax-highlighter/scripts/shBrushCss.js"></script>
<script src="js/syntax-highlighter/scripts/shBrushJScript.js"></script>
<script src="js/syntax-highlighter/scripts/shBrushTypeScript.js"></script>

</body>

</html>
